# 表达式

## 操作符

> 算数操作符

| 操作符 | 示例    | 描述                 |
| ------ | ------- | -------------------- |
| +      | a + b   | 加法                 |
| -      | a - b   | 减法                 |
| \*     | a \* b  | 乘法                 |
| /      | a / b   | 除法（浮点除法）     |
| DIV    | a DIV b | 除法，取商的整数部分 |
| %      | a % b   | 取余                 |
| -      | -a      | 负号                 |

> 比较操作符

| 操作符      | 示例                   | 描述                            |
| ----------- | ---------------------- | ------------------------------- |
| =           | a = b                  | a 等于 b                        |
| <> 或者 !=  | a <> b 或者 a != b     | a 不等于 b                      |
| <           | a < b                  | a 小于 b                        |
| <=          | a <= b                 | a 小于或等于 b                  |
| >           | a > b                  | a 大于 b                        |
| >=          | a >= b                 | a 大于或等于 b                  |
| BETWEEN     | a BETWEEN b AND c      | 满足 b <= a <= c                |
| NOT BETWEEN | a NOT BETWEEN b AND c  | 不满足 b <= a <= c              |
| IN          | a IN (b1, b2, ...)     | a 是 b1, b2, ... 中的某一个     |
| NOT IN      | a NOT IN (b1, b2, ...) | a 不是 b1, b2, ... 中的任意一个 |
| IS NULL     | a IS NULL              | a 的值是 NULL                   |
| IS NOT NULL | a IS NOT NULL          | a 的值不是 NULL                 |
| LIKE        | a LIKE b               | a 匹配 b                        |
| NOT LIKE    | a NOT LIKE b           | a 不匹配 b                      |

> 逻辑操作符

| 操作符 | 示例    | 描述                                     |
| ------ | ------- | ---------------------------------------- |
| AND    | a AND b | 只有 a 和 b 同时为真，表达式才为真       |
| OR     | a OR b  | 只要 a 或 b 有任意一个为真，表达式就为真 |
| XOR    | a XOR b | a 和 b 有且只有一个为真，表达式为真      |

`操作符与操作数组合形成一个表达式，操作数可以是常数、列名、函数、标量子查询、行子查询、其他表达式等。`

```sql
# 查询出的成绩都加上100
SELECT  number, stu_subject, score + 100 FROM student_score;
```

## 函数

> 文本处理函数

| 名称      | 调用示例                    | 示例结果  | 描述                                   |
| --------- | --------------------------- | --------- | -------------------------------------- |
| LEFT      | LEFT('abc123', 3)           | abc       | 给定字符串从左边取指定长度的子串       |
| RIGHT     | RIGHT('abc123', 3)          | 123       | 给定字符串从右边取指定长度的子串       |
| LENGTH    | LENGTH('abc')               | 3         | 给定字符串的长度                       |
| LOWER     | LOWER('ABC')                | abc       | 给定字符串的小写格式                   |
| UPPER     | UPPER('abc')                | ABC       | 给定字符串的大写格式                   |
| LTRIM     | LTRIM(' abc')               | abc       | 给定字符串左边空格去除后的格式         |
| RTRIM     | RTRIM('abc ')               | abc       | 给定字符串右边空格去除后的格式         |
| SUBSTRING | SUBSTRING('abc123', 2, 3)   | bc1       | 给定字符串从指定位置截取指定长度的子串 |
| CONCAT    | CONCAT('abc', '123', 'xyz') | abc123xyz | 将给定的各个字符串拼接成一个新字符串   |

> 日期和时间处理函数

| 名称        | 调用示例                                        | 示例结果            | 描述                                                         |
| ----------- | ----------------------------------------------- | ------------------- | ------------------------------------------------------------ |
| NOW         | NOW()                                           | 2019-08-16 17:10:43 | 返回当前日期和时间                                           |
| CURDATE     | CURDATE()                                       | 2019-08-16          | 返回当前日期                                                 |
| CURTIME     | CURTIME()                                       | 17:10:43            | 返回当前时间                                                 |
| DATE        | DATE('2019-08-16 17:10:43')                     | 2019-08-16          | 将给定日期和时间值的日期提取出来                             |
| DATE_ADD    | DATE_ADD('2019-08-16 17:10:43', INTERVAL 2 DAY) | 2019-08-18 17:10:43 | 将给定的日期和时间值添加指定的时间间隔                       |
| DATE_SUB    | DATE_SUB('2019-08-16 17:10:43', INTERVAL 2 DAY) | 2019-08-14 17:10:43 | 将给定的日期和时间值减去指定的时间间隔                       |
| DATEDIFF    | DATEDIFF('2019-08-16', '2019-08-17')            | -1                  | 返回两个日期之间的天数（负数代表前一个参数代表的日期比较小） |
| DATE_FORMAT | DATE_FORMAT(NOW(),'%m-%d-%Y')                   | 08-16-2019          | 用给定的格式显示日期和时间                                   |

> 数值处理函数

| 名称 | 调用示例    | 示例结果           | 描述               |
| ---- | ----------- | ------------------ | ------------------ |
| ABS  | ABS(-1)     | 1                  | 取绝对值           |
| Pi   | PI()        | 3.141593           | 返回圆周率         |
| COS  | COS(PI())   | -1                 | 返回一个角度的余弦 |
| EXP  | EXP(1)      | 2.718281828459045  | 返回 e 的指定次方  |
| MOD  | MOD(5,2)    | 1                  | 返回除法的余数     |
| RAND | RAND()      | 0.7537623539136372 | 返回一个随机数     |
| SIN  | SIN(PI()/2) | 1                  | 返回一个角度的正弦 |
| SQRT | SQRT(9)     | 3                  | 返回一个数的平方根 |
| TAN  | TAN(0)      | 0                  | 返回一个角度的正切 |

> 聚集函数(统计函数)

| 函数名 | 描述                                                                     |
| ------ | ------------------------------------------------------------------------ |
| COUNT  | 返回某列的行数，使用\*时返回说有列数，不忽略 NULL，指定列名时会忽略 NULL |
| MAX    | 返回某列的最大值                                                         |
| MIN    | 返回某列的最小值                                                         |
| SUM    | 返回某列值之和                                                           |
| AVG    | 返回某列的平均值                                                         |

```sql
# 统计母猪的产后护理科目的平均成绩
SELECT AVG(score) FROM student_score WHERE stu_subject = '母猪的产后护理';

# 统计一共有多少种科目
SELECT COUNT(DISTINCT major) FROM student_info;

# 统计最高分，最低分，平均分
SELECT COUNT(*) AS 成绩记录总数, MAX(score) AS 最高成绩, MIN(score) AS 最低成绩, AVG(score) AS 平均成绩 FROM student_score;
```
